#WPF #WF #ACTIVE_LIBRARY

[시작 자습서](시작%20자습서.md)

> [!Quote]- Quote
> https://learn.microsoft.com/ko-kr/dotnet/framework/windows-workflow-foundation/how-to-create-an-activity

## Active Library Project 만들기

![](attachments/Pasted%20image%2020240412235630.png)

![](attachments/Pasted%20image%2020240413000651.png)

>**솔루션 탐색기**에서 **Activity1.xaml**을 마우스 오른쪽 단추로 클릭하고 **삭제**를 선택합니다. **확인** 을 클릭하여 확인합니다.

## ReadInt 활동 만들기

> 새 항목 추가 -> 설치됨 > 공통 항목 노드 
> -> Workflow -> 코드 활동

![](attachments/Pasted%20image%2020240413001251.png)


> [!INFO] 참고
>![](attachments/Pasted%20image%2020240413001636.png)

``` C#
using System;
using System.Activities;

public sealed class ReadInt : NativeActivity<int>
{
    [RequiredArgument]
    public InArgument<string> BookmarkName { get; set; }

    protected override void Execute(NativeActivityContext context)
    {
        string name = BookmarkName.Get(context);

        if (string.IsNullOrEmpty(name))
        {
            throw new ArgumentException("BookmarkName cannot be an Empty string.",
                "context");
        }

        context.CreateBookmark(name, new BookmarkCallback(OnReadComplete));
        // 북마크를 걸고 해당 활동은 종료가 되고, 
        // 해당 북마크에 대한 호출이 있을 때, 
        // 미리 등록한 콜백 함수가 호출된다.
    }

    // NativeActivity derived activities that do asynchronous operations by calling
    // one of the CreateBookmark overloads defined on System.Activities.NativeActivityContext
    // must override the CanInduceIdle property and return true.
    protected override bool CanInduceIdle
    {
        get { return true; }
    }

    void OnReadComplete(NativeActivityContext context, Bookmark bookmark, object state)
    {
        this.Result.Set(context, Convert.ToInt32(state));
    }
}
```


> [!Tip] Tip - Bookmark 생성 후 사용자 입력 처리
> ```
>// public sealed class UserDefineActivity : NativeActivity : T
>
> protected override void Execute(NativeActivityContext context)
> {
>	// 북마크를 걸고 해당 활동은 종료가 되고, 
>	// 해당 북마크에 대한 호출이 있을 때, 
>	// 미리 등록한 콜백 함수가 호출된다.
>	context.CreateBookmark("북마크이름", new BookmarkCallback(OnReadComplete));
>}
>protected override bool CanInduceIdle
> {
> 	get { return true; }
>}
> void OnReadComplete(NativeActivityContext context, Bookmark bookmark, object state)
> {
> 	this.Result.Set(context, Convert.ToInt32(state));
>}
> -------------------------------------------------------------------------------------------
>// 북마크 재개
> wfApp.ResumeBookmark("북마크이름", 외부입력데이터 : T);
> ```


*Ctrl+Shift+B*

## Prompt 활동 만들기

> 새 항목 추가 -> 설치됨 > 공통 항목 노드 
> -> Workflow -> 활동

### 01. 활동 항목 추가

![](attachments/Pasted%20image%2020240423141805.png)
### 02. 인수 추가

![](attachments/Pasted%20image%2020240423142207.png)
![](attachments/Pasted%20image%2020240423142236.png)
- 이 세 가지 인수는 다음 단계에서 [WriteLine](https://learn.microsoft.com/ko-kr/dotnet/api/system.activities.statements.writeline) 활동에 추가되는 `ReadInt` 및 `Prompt` 활동의 해당 인수에 바인딩됩니다.
### 03. 흐름제어

![](attachments/Pasted%20image%2020240423142835.png)

![](attachments/Pasted%20image%2020240423143045.png)

![](attachments/Pasted%20image%2020240423143218.png)

*Ctrl+Shift+B
